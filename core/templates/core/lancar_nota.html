{% extends 'core/base.html' %}
{% load custom_tags %}
{% load static %}

{% block title %}Lançar Notas - {{ disciplina.nome }}{% endblock %}
{% block header_title %}Lançar Notas para {{ disciplina.nome }} ({{ disciplina.turma }}){% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'core/css/paineldoc.css' %}">
{% endblock %}

{% block user_info %}
  <span>Olá, <a href="{% url 'editar_perfil_professor' %}">{{ request.user.get_full_name|default:request.user.username }}</a></span>
  <a href="{% url 'painel_professor' %}"><i class="fas fa-arrow-left"></i></a>
  <a href="{% url 'logout' %}"><i class="fas fa-power-off"></i></a>
{% endblock %}

{% block content %}
<form method="post" style="width: 100%; max-width: 1200px; margin: auto;">
  {% csrf_token %}
  
  <div class="bloco">
    <div class="painel">
      <div class="cabecalho">
        <h2>{{ disciplina.nome }}</h2>
        <span>| {{ disciplina.turma.nome }}</span>
      </div>
      <div class="conteudo">
        <div class="tabela-wrapper">
          <table>
            <thead>
              <tr>
                <th>Aluno</th>
                <th>1º</th>
                <th>2º</th>
                <th>3º</th>
                <th>4º</th>
                <th>Média</th>
              </tr>
            </thead>
            <tbody>
              {% for aluno in alunos %}
              <tr>
                <td>{{ aluno.user.get_full_name }}</td>
                {% with nota=notas_dict|get_item:aluno.id %}
                  <td><input type="text" name="nota1_{{ aluno.id }}" value="{{ nota.nota1|default_if_none:'' }}" class="nota-input"></td>
                  <td><input type="text" name="nota2_{{ aluno.id }}" value="{{ nota.nota2|default_if_none:'' }}" class="nota-input"></td>
                  <td><input type="text" name="nota3_{{ aluno.id }}" value="{{ nota.nota3|default_if_none:'' }}" class="nota-input"></td>
                  <td><input type="text" name="nota4_{{ aluno.id }}" value="{{ nota.nota4|default_if_none:'' }}" class="nota-input"></td>
                  <td>
                    {% if nota.media %}
                      {{ nota.media|floatformat:2 }}
                    {% else %}
                      -
                    {% endif %}
                  </td>
                {% endwith %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <button type="submit" class="salvar">
      Salvar <img src="{% static 'core/img/tl.webp' %}" alt="Disquete" class="icone-disquete">
    </button>
  </div>
  
</form>
{% endblock %}
